{"ast":null,"code":"import _regeneratorRuntime from\"/Users/amandagifford/SoftwareEngineering/ThriveTogetherFrontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/amandagifford/SoftwareEngineering/ThriveTogetherFrontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/amandagifford/SoftwareEngineering/ThriveTogetherFrontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from'react';import{connect}from'react-redux';import{setRecipient}from'./recipientActions';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function InboxCards(props){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),messagesData=_useState2[0],setMessagesData=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),userData=_useState4[0],setUserData=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),userDataLoaded=_useState6[0],setUserDataLoaded=_useState6[1];useEffect(function(){function getUserData(){return _getUserData.apply(this,arguments);}function _getUserData(){_getUserData=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var url,response,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:url=\"\".concat(process.env.REACT_APP_API_HOST,\"/token\");_context.next=3;return fetch(url,{credentials:\"include\"});case 3:response=_context.sent;_context.next=6;return response.json();case 6:data=_context.sent;if(response.ok){setUserData(data.account);setUserDataLoaded(true);}else{console.log(\"Your data could not be fetched\");}case 8:case\"end\":return _context.stop();}}},_callee);}));return _getUserData.apply(this,arguments);}getUserData();},[userDataLoaded]);useEffect(function(){function getMessagesData(){return _getMessagesData.apply(this,arguments);}function _getMessagesData(){_getMessagesData=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var url,response,data;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!(!userDataLoaded||!userData)){_context2.next=4;break;}return _context2.abrupt(\"return\");case 4:url=\"\".concat(process.env.REACT_APP_API_HOST,\"/messages/\").concat(userData[\"id\"]);_context2.next=7;return fetch(url,{credentials:\"include\"});case 7:response=_context2.sent;_context2.next=10;return response.json();case 10:data=_context2.sent;if(response.ok){setMessagesData(data);}else{console.log(\"could not return user messages\");}case 12:case\"end\":return _context2.stop();}}},_callee2);}));return _getMessagesData.apply(this,arguments);}getMessagesData();},[userData,userDataLoaded]);var handleSetRecipient=function handleSetRecipient(userId){props.setRecipient({recipient:userId});};return/*#__PURE__*/_jsx(\"div\",{className:\"container mt-4\",children:/*#__PURE__*/_jsx(\"div\",{className:\"row justify-content-start\",children:/*#__PURE__*/_jsx(\"div\",{className:\"col-lg-6\",children:messagesData.map(function(conversation){return/*#__PURE__*/_jsxs(\"div\",{className:\"card mb-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"card-body\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex align-items-center mb-2\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"rounded-circle overflow-hidden me-2\",style:{width:'40px',height:'40px'},children:/*#__PURE__*/_jsx(\"img\",{src:conversation[0].profile_image,alt:\"Profile\",className:\"img-fluid\"})}),/*#__PURE__*/_jsx(\"strong\",{children:conversation[0].username})]}),/*#__PURE__*/_jsx(\"div\",{className:\"d-flex justify-content-center mt-2\",children:/*#__PURE__*/_jsx(\"p\",{children:conversation[0].content})}),/*#__PURE__*/_jsx(\"small\",{className:\"text-muted\",children:new Date(conversation[0].date).toLocaleString('en-US',{dateStyle:'medium',timeStyle:'short'})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"d-flex justify-content-left mt-2\",children:/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-sm btn-primary mb-2\",onClick:function onClick(){return handleSetRecipient(conversation[0].user_id);},children:\"Message\"})})]},conversation[0].id);})})})});};var mapStateToProps=function mapStateToProps(state){return{recipient:state.recipient};};export default connect(mapStateToProps,{setRecipient:setRecipient})(InboxCards);","map":{"version":3,"names":["React","useEffect","useState","connect","setRecipient","InboxCards","props","messagesData","setMessagesData","userData","setUserData","userDataLoaded","setUserDataLoaded","getUserData","url","process","env","REACT_APP_API_HOST","fetch","credentials","response","json","data","ok","account","console","log","getMessagesData","handleSetRecipient","userId","recipient","map","conversation","width","height","profile_image","username","content","Date","date","toLocaleString","dateStyle","timeStyle","user_id","id","mapStateToProps","state"],"sources":["/Users/amandagifford/SoftwareEngineering/ThriveTogetherFrontend/src/Messages/InboxCards.js"],"sourcesContent":["import React, {useEffect, useState} from 'react';\nimport { connect } from 'react-redux';\nimport { setRecipient } from './recipientActions';\n\n\n\nfunction InboxCards(props) {\n    const [messagesData, setMessagesData] = useState([]);\n    const [userData, setUserData] = useState([]);\n    const [userDataLoaded, setUserDataLoaded] = useState(false);\n\n\n    useEffect(() => {\n        async function getUserData() {\n            let url = `${process.env.REACT_APP_API_HOST}/token`;\n            let response = await fetch(url, {\n                credentials: \"include\",\n            });\n            let data = await response.json()\n\n            if (response.ok) {\n                setUserData(data.account)\n                setUserDataLoaded(true);\n            } else {\n                console.log(\"Your data could not be fetched\")\n            }\n        }\n\n        getUserData();\n    }, [userDataLoaded]);\n\n    useEffect(() => {\n        async function getMessagesData() {\n            if (!userDataLoaded || !userData) {\n              return;\n            } else {\n                let url = `${process.env.REACT_APP_API_HOST}/messages/${userData[\"id\"]}`;\n                let response = await fetch(\n                    url,\n                    {\n                    credentials: \"include\",\n                    }\n                );\n                let data = await response.json()\n                if (response.ok) {\n                  setMessagesData(data)\n                } else {\n                  console.log(\"could not return user messages\")\n            }\n                }\n        }\n\n        getMessagesData();\n    }, [userData, userDataLoaded]);\n\n    const handleSetRecipient = (userId) => {\n      props.setRecipient({recipient: userId});\n    };\n\n   return (\n    <div className=\"container mt-4\">\n      <div className=\"row justify-content-start\">\n        <div className=\"col-lg-6\">\n            {messagesData.map((conversation) => (\n          <div key={conversation[0].id} className=\"card mb-4\">\n            <div className=\"card-body\">\n                <div className=\"d-flex align-items-center mb-2\">\n                  <div className=\"rounded-circle overflow-hidden me-2\" style={{ width: '40px', height: '40px' }}>\n                    <img src={conversation[0].profile_image} alt=\"Profile\" className=\"img-fluid\" />\n                  </div>\n                  <strong>{conversation[0].username}</strong>\n                </div>\n                <div className=\"d-flex justify-content-center mt-2\">\n                <p>{conversation[0].content}</p>\n                </div>\n                <small className=\"text-muted\">{new Date(conversation[0].date).toLocaleString('en-US', { dateStyle: 'medium', timeStyle: 'short' })}</small>\n            </div>\n            <div className=\"d-flex justify-content-left mt-2\">\n              <button className=\"btn btn-sm btn-primary mb-2\" onClick={() => handleSetRecipient(conversation[0].user_id)}>Message</button>\n          </div>\n          </div>\n        ))}\n      </div>\n    </div>\n    </div>\n  );\n};\n\nconst mapStateToProps = (state) => ({\n  recipient: state.recipient,\n});\n\nexport default connect(mapStateToProps, { setRecipient })(InboxCards);\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}