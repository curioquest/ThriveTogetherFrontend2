{"ast":null,"code":"import _regeneratorRuntime from\"/Users/amandagifford/SoftwareEngineering/ThriveTogetherFrontend2/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/amandagifford/SoftwareEngineering/ThriveTogetherFrontend2/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/amandagifford/SoftwareEngineering/ThriveTogetherFrontend2/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";var _this=this;import{useEffect,useState}from\"react\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var PeerConnectionList=function PeerConnectionList(){var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),peerRequest=_useState2[0],setpeerRequest=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),loginAccount=_useState4[0],setLoginAccount=_useState4[1];useEffect(function(){function getPeerData(){return _getPeerData.apply(this,arguments);}function _getPeerData(){_getPeerData=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var url,response,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:url=\"\".concat(process.env.REACT_APP_API_HOST,\"/token\");_context.next=3;return fetch(url,{credentials:\"include\"});case 3:response=_context.sent;_context.next=6;return response.json();case 6:data=_context.sent;if(response.ok){setLoginAccount(data.account);}case 8:case\"end\":return _context.stop();}}},_callee);}));return _getPeerData.apply(this,arguments);}getPeerData();},[]);useEffect(function(){function showPeerRequest(){return _showPeerRequest.apply(this,arguments);}function _showPeerRequest(){_showPeerRequest=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var listUrl,response,data;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(loginAccount){_context2.next=2;break;}return _context2.abrupt(\"return\");case 2:listUrl=\"\".concat(process.env.REACT_APP_API_HOST,\"/api/peer_connections/\").concat(loginAccount.id);_context2.next=5;return fetch(listUrl,{credentials:\"include\"});case 5:response=_context2.sent;if(!response.ok){_context2.next=11;break;}_context2.next=9;return response.json();case 9:data=_context2.sent;setpeerRequest(data.peerConnections);case 11:case\"end\":return _context2.stop();}}},_callee2);}));return _showPeerRequest.apply(this,arguments);}showPeerRequest();},[loginAccount]);var handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(event){var approve_data,approve_data2,locationUrl,fetchConfig,response,approveUrl,approveConfig,_response,_approveUrl,approveConfig2,response2;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:approve_data={};approve_data2={};locationUrl=\"\".concat(process.env.REACT_APP_API_HOST,\"/api/peerRequest/operate/\").concat(event.peerConnections.recipient,\"/\").concat(event.peerConnections.sender,\"/\").concat(event.operate);fetchConfig={method:\"post\",body:JSON.stringify(),headers:{\"Content-Type\":\"application/json\"},credentials:\"include\"};_context3.next=6;return fetch(locationUrl,fetchConfig);case 6:response=_context3.sent;if(!response.ok){_context3.next=24;break;}if(event.operate===\"Reject\"){refreshPage();}if(!(event.operate===\"Approve\")){_context3.next=24;break;}approveUrl=\"\".concat(process.env.REACT_APP_API_HOST,\"/api/peerAdd\");approve_data={user_id:event.peerConnections.recipient,peer_id:event.peerConnections.sender,peer_name:event.peerConnections.sender_name,profile_link:\"\",tags_id:1,profile_image:\"\",status:0};approveConfig={method:\"post\",body:JSON.stringify(approve_data),headers:{\"Content-Type\":\"application/json\"},credentials:\"include\"};_context3.next=15;return fetch(approveUrl,approveConfig);case 15:_response=_context3.sent;if(!_response.ok){_context3.next=24;break;}_approveUrl=\"\".concat(process.env.REACT_APP_API_HOST,\"/api/peerAdd\");approve_data2={user_id:event.peerConnections.sender,peer_id:event.peerConnections.recipient,peer_name:event.loginAccount.name,profile_link:\"\",tags_id:1,profile_image:\"\",status:0};approveConfig2={method:\"post\",body:JSON.stringify(approve_data2),headers:{\"Content-Type\":\"application/json\"},credentials:\"include\"};_context3.next=22;return fetch(_approveUrl,approveConfig2);case 22:response2=_context3.sent;if(response2.ok){refreshPage();}case 24:case\"end\":return _context3.stop();}}},_callee3);}));return function handleSubmit(_x){return _ref.apply(this,arguments);};}();var refreshPage=function refreshPage(){window.location.reload();};return/*#__PURE__*/_jsx(\"div\",{className:\"container content-container rounded-edges\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"table table-striped\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Peer Request Name\"}),/*#__PURE__*/_jsx(\"th\",{children:\"message\"}),/*#__PURE__*/_jsx(\"th\",{children:\"status\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Operate\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:Array.from(peerRequest).map(function(peerConnections){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:peerConnections.sender_name}),/*#__PURE__*/_jsx(\"td\",{children:peerConnections.has_messaged}),/*#__PURE__*/_jsx(\"td\",{children:peerConnections.status}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"div\",{style:{display:peerConnections.status===\"pending\"?\"\":\"none\"},children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-outline-warning\",onClick:handleSubmit.bind(_this,{peerConnections:peerConnections,loginAccount:loginAccount,operate:\"Approve\"}),children:\"Approve\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-outline-warning\",onClick:handleSubmit.bind(_this,{peerConnections:peerConnections,operate:\"Reject\"}),children:\"Reject\"})]})})]},peerConnections.sender_name+peerConnections.recipient);})})]})});};export default PeerConnectionList;","map":{"version":3,"names":["useEffect","useState","PeerConnectionList","peerRequest","setpeerRequest","loginAccount","setLoginAccount","getPeerData","url","process","env","REACT_APP_API_HOST","fetch","credentials","response","json","data","ok","account","showPeerRequest","listUrl","id","peerConnections","handleSubmit","event","approve_data","approve_data2","locationUrl","recipient","sender","operate","fetchConfig","method","body","JSON","stringify","headers","refreshPage","approveUrl","user_id","peer_id","peer_name","sender_name","profile_link","tags_id","profile_image","status","approveConfig","name","approveConfig2","response2","window","location","reload","Array","from","map","has_messaged","display","bind"],"sources":["/Users/amandagifford/SoftwareEngineering/ThriveTogetherFrontend2/src/PeerConnectionList.js"],"sourcesContent":["import { useEffect, useState } from \"react\";\n\nconst PeerConnectionList = () => {\n  const [peerRequest, setpeerRequest] = useState(\"\");\n  const [loginAccount, setLoginAccount] = useState(\"\");\n\n  useEffect(() => {\n    async function getPeerData() {\n      const url = `${process.env.REACT_APP_API_HOST}/token`;\n      const response = await fetch(url, {\n        credentials: \"include\",\n      });\n\n      const data = await response.json();\n      if (response.ok) {\n        setLoginAccount(data.account);\n      }\n    }\n\n    getPeerData();\n  }, []);\n\n  useEffect(() => {\n    async function showPeerRequest() {\n      if (!loginAccount) {\n        return;\n      }\n      let listUrl = `${process.env.REACT_APP_API_HOST}/api/peer_connections/${loginAccount.id}`;\n      const response = await fetch(listUrl, {\n        credentials: \"include\",\n      });\n      if (response.ok) {\n        const data = await response.json();\n        setpeerRequest(data.peerConnections);\n      }\n    }\n\n    showPeerRequest();\n  }, [loginAccount]);\n\n  const handleSubmit = async (event) => {\n    let approve_data = {};\n    let approve_data2 = {};\n    let locationUrl = `${process.env.REACT_APP_API_HOST}/api/peerRequest/operate/${event.peerConnections.recipient}/${event.peerConnections.sender}/${event.operate}`;\n    const fetchConfig = {\n      method: \"post\",\n      body: JSON.stringify(),\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n      credentials: \"include\",\n    };\n    const response = await fetch(locationUrl, fetchConfig);\n    if (response.ok) {\n      if (event.operate === \"Reject\") {\n        refreshPage();\n      }\n      if (event.operate === \"Approve\") {\n        let approveUrl = `${process.env.REACT_APP_API_HOST}/api/peerAdd`;\n        approve_data = {\n          user_id: event.peerConnections.recipient,\n          peer_id: event.peerConnections.sender,\n          peer_name: event.peerConnections.sender_name,\n          profile_link: \"\",\n          tags_id: 1,\n          profile_image: \"\",\n          status: 0,\n        };\n        const approveConfig = {\n          method: \"post\",\n          body: JSON.stringify(approve_data),\n          headers: {\n            \"Content-Type\": \"application/json\",\n          },\n          credentials: \"include\",\n        };\n        const response = await fetch(approveUrl, approveConfig);\n        if (response.ok) {\n          let approveUrl = `${process.env.REACT_APP_API_HOST}/api/peerAdd`;\n          approve_data2 = {\n            user_id: event.peerConnections.sender,\n            peer_id: event.peerConnections.recipient,\n            peer_name: event.loginAccount.name,\n            profile_link: \"\",\n            tags_id: 1,\n            profile_image: \"\",\n            status: 0,\n          };\n          const approveConfig2 = {\n            method: \"post\",\n            body: JSON.stringify(approve_data2),\n            headers: {\n              \"Content-Type\": \"application/json\",\n            },\n            credentials: \"include\",\n          };\n          const response2 = await fetch(approveUrl, approveConfig2);\n          if (response2.ok) {\n            refreshPage();\n          }\n        }\n      }\n    }\n  };\n\n  const refreshPage = () => {\n    window.location.reload();\n  };\n\n  return (\n    <div className=\"container content-container rounded-edges\">\n      <table className=\"table table-striped\">\n        <thead>\n          <tr>\n            <th>Peer Request Name</th>\n            <th>message</th>\n            <th>status</th>\n            <th>Operate</th>\n          </tr>\n        </thead>\n        <tbody>\n          {Array.from(peerRequest).map((peerConnections) => {\n            return (\n              <tr key={peerConnections.sender_name + peerConnections.recipient}>\n                <td>{peerConnections.sender_name}</td>\n                <td>{peerConnections.has_messaged}</td>\n                <td>{peerConnections.status}</td>\n                <td>\n                  <div\n                    style={{\n                      display:\n                        peerConnections.status === \"pending\" ? \"\" : \"none\",\n                    }}\n                  >\n                    <button\n                      className=\"btn btn-outline-warning\"\n                      onClick={handleSubmit.bind(this, {\n                        peerConnections,\n                        loginAccount,\n                        operate: \"Approve\",\n                      })}\n                    >\n                      Approve\n                    </button>\n                    <button\n                      className=\"btn btn-outline-warning\"\n                      onClick={handleSubmit.bind(this, {\n                        peerConnections,\n                        operate: \"Reject\",\n                      })}\n                    >\n                      Reject\n                    </button>\n                  </div>\n                </td>\n              </tr>\n            );\n          })}\n        </tbody>\n      </table>\n    </div>\n  );\n};\n\nexport default PeerConnectionList;\n"],"mappings":"ieAAA,OAASA,SAAT,CAAoBC,QAApB,KAAoC,OAApC,C,wFAEA,GAAMC,mBAAkB,CAAG,QAArBA,mBAAqB,EAAM,CAC/B,cAAsCD,QAAQ,CAAC,EAAD,CAA9C,wCAAOE,WAAP,eAAoBC,cAApB,eACA,eAAwCH,QAAQ,CAAC,EAAD,CAAhD,yCAAOI,YAAP,eAAqBC,eAArB,eAEAN,SAAS,CAAC,UAAM,SACCO,YADD,6IACd,2JACQC,GADR,WACiBC,OAAO,CAACC,GAAR,CAAYC,kBAD7B,iCAEyBC,MAAK,CAACJ,GAAD,CAAM,CAChCK,WAAW,CAAE,SADmB,CAAN,CAF9B,QAEQC,QAFR,qCAMqBA,SAAQ,CAACC,IAAT,EANrB,QAMQC,IANR,eAOE,GAAIF,QAAQ,CAACG,EAAb,CAAiB,CACfX,eAAe,CAACU,IAAI,CAACE,OAAN,CAAf,CACD,CATH,sDADc,8CAadX,WAAW,GACZ,CAdQ,CAcN,EAdM,CAAT,CAgBAP,SAAS,CAAC,UAAM,SACCmB,gBADD,yJACd,uKACOd,YADP,mEAIMe,OAJN,WAImBX,OAAO,CAACC,GAAR,CAAYC,kBAJ/B,kCAI0EN,YAAY,CAACgB,EAJvF,yBAKyBT,MAAK,CAACQ,OAAD,CAAU,CACpCP,WAAW,CAAE,SADuB,CAAV,CAL9B,QAKQC,QALR,oBAQMA,QAAQ,CAACG,EARf,kDASuBH,SAAQ,CAACC,IAAT,EATvB,QASUC,IATV,gBAUIZ,cAAc,CAACY,IAAI,CAACM,eAAN,CAAd,CAVJ,yDADc,kDAedH,eAAe,GAChB,CAhBQ,CAgBN,CAACd,YAAD,CAhBM,CAAT,CAkBA,GAAMkB,aAAY,4FAAG,kBAAOC,KAAP,gQACfC,YADe,CACA,EADA,CAEfC,aAFe,CAEC,EAFD,CAGfC,WAHe,WAGElB,OAAO,CAACC,GAAR,CAAYC,kBAHd,qCAG4Da,KAAK,CAACF,eAAN,CAAsBM,SAHlF,aAG+FJ,KAAK,CAACF,eAAN,CAAsBO,MAHrH,aAG+HL,KAAK,CAACM,OAHrI,EAIbC,WAJa,CAIC,CAClBC,MAAM,CAAE,MADU,CAElBC,IAAI,CAAEC,IAAI,CAACC,SAAL,EAFY,CAGlBC,OAAO,CAAE,CACP,eAAgB,kBADT,CAHS,CAMlBvB,WAAW,CAAE,SANK,CAJD,wBAYID,MAAK,CAACe,WAAD,CAAcI,WAAd,CAZT,QAYbjB,QAZa,oBAafA,QAAQ,CAACG,EAbM,2BAcjB,GAAIO,KAAK,CAACM,OAAN,GAAkB,QAAtB,CAAgC,CAC9BO,WAAW,GACZ,CAhBgB,KAiBbb,KAAK,CAACM,OAAN,GAAkB,SAjBL,4BAkBXQ,UAlBW,WAkBK7B,OAAO,CAACC,GAAR,CAAYC,kBAlBjB,iBAmBfc,YAAY,CAAG,CACbc,OAAO,CAAEf,KAAK,CAACF,eAAN,CAAsBM,SADlB,CAEbY,OAAO,CAAEhB,KAAK,CAACF,eAAN,CAAsBO,MAFlB,CAGbY,SAAS,CAAEjB,KAAK,CAACF,eAAN,CAAsBoB,WAHpB,CAIbC,YAAY,CAAE,EAJD,CAKbC,OAAO,CAAE,CALI,CAMbC,aAAa,CAAE,EANF,CAObC,MAAM,CAAE,CAPK,CAAf,CASMC,aA5BS,CA4BO,CACpBf,MAAM,CAAE,MADY,CAEpBC,IAAI,CAAEC,IAAI,CAACC,SAAL,CAAeV,YAAf,CAFc,CAGpBW,OAAO,CAAE,CACP,eAAgB,kBADT,CAHW,CAMpBvB,WAAW,CAAE,SANO,CA5BP,yBAoCQD,MAAK,CAAC0B,UAAD,CAAaS,aAAb,CApCb,SAoCTjC,SApCS,oBAqCXA,SAAQ,CAACG,EArCE,2BAsCTqB,WAtCS,WAsCO7B,OAAO,CAACC,GAAR,CAAYC,kBAtCnB,iBAuCbe,aAAa,CAAG,CACda,OAAO,CAAEf,KAAK,CAACF,eAAN,CAAsBO,MADjB,CAEdW,OAAO,CAAEhB,KAAK,CAACF,eAAN,CAAsBM,SAFjB,CAGda,SAAS,CAAEjB,KAAK,CAACnB,YAAN,CAAmB2C,IAHhB,CAIdL,YAAY,CAAE,EAJA,CAKdC,OAAO,CAAE,CALK,CAMdC,aAAa,CAAE,EAND,CAOdC,MAAM,CAAE,CAPM,CAAhB,CASMG,cAhDO,CAgDU,CACrBjB,MAAM,CAAE,MADa,CAErBC,IAAI,CAAEC,IAAI,CAACC,SAAL,CAAeT,aAAf,CAFe,CAGrBU,OAAO,CAAE,CACP,eAAgB,kBADT,CAHY,CAMrBvB,WAAW,CAAE,SANQ,CAhDV,yBAwDWD,MAAK,CAAC0B,WAAD,CAAaW,cAAb,CAxDhB,SAwDPC,SAxDO,gBAyDb,GAAIA,SAAS,CAACjC,EAAd,CAAkB,CAChBoB,WAAW,GACZ,CA3DY,yDAAH,kBAAZd,aAAY,4CAAlB,CAiEA,GAAMc,YAAW,CAAG,QAAdA,YAAc,EAAM,CACxBc,MAAM,CAACC,QAAP,CAAgBC,MAAhB,GACD,CAFD,CAIA,mBACE,YAAK,SAAS,CAAC,2CAAf,uBACE,eAAO,SAAS,CAAC,qBAAjB,wBACE,oCACE,mCACE,yCADF,cAEE,+BAFF,cAGE,8BAHF,cAIE,+BAJF,GADF,EADF,cASE,uBACGC,KAAK,CAACC,IAAN,CAAWpD,WAAX,EAAwBqD,GAAxB,CAA4B,SAAClC,eAAD,CAAqB,CAChD,mBACE,mCACE,oBAAKA,eAAe,CAACoB,WAArB,EADF,cAEE,oBAAKpB,eAAe,CAACmC,YAArB,EAFF,cAGE,oBAAKnC,eAAe,CAACwB,MAArB,EAHF,cAIE,iCACE,aACE,KAAK,CAAE,CACLY,OAAO,CACLpC,eAAe,CAACwB,MAAhB,GAA2B,SAA3B,CAAuC,EAAvC,CAA4C,MAFzC,CADT,wBAME,eACE,SAAS,CAAC,yBADZ,CAEE,OAAO,CAAEvB,YAAY,CAACoC,IAAb,CAAkB,KAAlB,CAAwB,CAC/BrC,eAAe,CAAfA,eAD+B,CAE/BjB,YAAY,CAAZA,YAF+B,CAG/ByB,OAAO,CAAE,SAHsB,CAAxB,CAFX,qBANF,cAgBE,eACE,SAAS,CAAC,yBADZ,CAEE,OAAO,CAAEP,YAAY,CAACoC,IAAb,CAAkB,KAAlB,CAAwB,CAC/BrC,eAAe,CAAfA,eAD+B,CAE/BQ,OAAO,CAAE,QAFsB,CAAxB,CAFX,oBAhBF,GADF,EAJF,GAASR,eAAe,CAACoB,WAAhB,CAA8BpB,eAAe,CAACM,SAAvD,CADF,CAmCD,CApCA,CADH,EATF,GADF,EADF,CAqDD,CAhKD,CAkKA,cAAe1B,mBAAf"},"metadata":{},"sourceType":"module"}